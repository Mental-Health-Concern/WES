<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Questionnaire_adding_validation</fullName>
    <active>true</active>
    <description>You can only add a questionnaire if the outcome of the appointment is either &apos;Attended on Time&apos; or &apos;Arrived late and seen&apos;</description>
    <errorConditionFormula>AND(
TEXT(Appointment__r.Outcome__c) != &apos;&apos;,
OR(
RecordType.Name = &quot;CORE10&quot;,
RecordType.Name = &quot;GAD7&quot;,
RecordType.Name = &quot;PHQ9&quot;),
TEXT(Appointment__r.Outcome__c) &lt;&gt; &apos;Attended on Time&apos;,
TEXT(Appointment__r.Outcome__c) &lt;&gt; &apos;Arrived late and seen&apos;
)&amp;&amp; $Setup.rh2__PS_Settings__c.rh2__Run_Validation_Rule__c</errorConditionFormula>
    <errorMessage>You can only add a questionnaire if the outcome of the appointment is either &apos;Attended on Time&apos; or &apos;Arrived late and seen&apos;</errorMessage>
</ValidationRule>
